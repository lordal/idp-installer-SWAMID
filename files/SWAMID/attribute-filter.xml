<?xml version="1.0" encoding="UTF-8"?>

<!--

The configuration documented here require Shibboleth IdP v2.3.4 or later, which fully supports using entity attributes in SP metadata as part of an attribute release filter policy

-->

<AttributeFilterPolicyGroup id="ShibbolethFilterPolicy"
        xmlns="urn:mace:shibboleth:2.0:afp"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="urn:mace:shibboleth:2.0:afp http://shibboleth.net/schema/idp/shibboleth-afp.xsd">
        
<!--  Release the transient ID to anyone -->
<AttributeFilterPolicy id="releaseTransientIdToAnyone">
	<PolicyRequirementRule xsi:type="ANY"/>

	<AttributeRule attributeID="transientId">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
</AttributeFilterPolicy>

<!-- EPTID FILTER PLACEHOLDER -->

<!-- entity-category-sfs-1993-1153 -->
<AttributeFilterPolicy id="entity-category-sfs-1993-1153">
	<PolicyRequirementRule xsi:type="saml:EntityAttributeExactMatch"
			attributeName="http://macedir.org/entity-category"
			attributeValue="http://www.swamid.se/category/sfs-1993-1153"/>

	<AttributeRule attributeID="norEduPersonNIN">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>


<!-- GEANT Dataprotection Code of Conduct -->
<AttributeFilterPolicy id="releaseToCoCo">
	<PolicyRequirementRule xsi:type="saml:AttributeRequesterEntityAttributeExactMatch"
			attributeName="http://macedir.org/entity-category"
			attributeValue="http://www.geant.net/uri/dataprotection-code-of-conduct/v1"/>
	<AttributeRule attributeID="displayName">
		<PermitValueRule xsi:type="saml:AttributeInMetadata" onlyIfRequired="true"/>
	</AttributeRule>
	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="saml:AttributeInMetadata" onlyIfRequired="true"/>
	</AttributeRule>
	<AttributeRule attributeID="eduPersonPrincipalName">
		<PermitValueRule xsi:type="saml:AttributeInMetadata" onlyIfRequired="true"/>
	</AttributeRule>
	<AttributeRule attributeID="eduPersonScopedAffiliation">
		<PolicyRequirementRule xsi:type="AND">
			<PermitValueRule xsi:type="OR">
				<Rule xsi:type="AttributeValueString" value="faculty" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="student" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="staff" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="alum" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="member" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="affiliate" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="employee" ignoreCase="true" />
				<Rule xsi:type="AttributeValueString" value="library-walk-in" ignoreCase="true" />
			</PermitValueRule>

			<PermitValueRule xsi:type="saml:AttributeInMetadata" onlyIfRequired="true"/>
		</PolicyRequirementRule>
	</AttributeRule>
	<AttributeRule attributeID="schacHomeOrganization">
		<PermitValueRule xsi:type="saml:AttributeInMetadata" onlyIfRequired="true"/>
	</AttributeRule>
</AttributeFilterPolicy>


<!-- REFEDS Research and Schoolarship -->
<AttributeFilterPolicy id="releaseToRandS">
	<PolicyRequirementRule xsi:type="saml:AttributeRequesterEntityAttributeExactMatch"
			attributeName="http://macedir.org/entity-category"
			attributeValue="http://refeds.org/category/research-and-scholarship"/>
	<AttributeRule attributeID="displayName">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
	<AttributeRule attributeID="givenName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="surname">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
	<AttributeRule attributeID="eduPersonPrincipalName">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
	<AttributeRule attributeID="eduPersonScopedAffiliation">
		<PermitValueRule xsi:type="OR">
			<Rule xsi:type="AttributeValueString" value="faculty" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="student" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="staff" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="alum" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="member" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="affiliate" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="employee" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="library-walk-in" ignoreCase="true" />
		</PermitValueRule>
	</AttributeRule>
</AttributeFilterPolicy>


<!-- entity-category-research-and-education -->
<AttributeFilterPolicy id="entity-category-research-and-education">
	<PolicyRequirementRule xsi:type="AND">
		<Rule xsi:type="OR">
			<Rule xsi:type="saml:EntityAttributeExactMatch"
				attributeName="http://macedir.org/entity-category"
				attributeValue="http://www.swamid.se/category/eu-adequate-protection"/>
			<Rule xsi:type="saml:EntityAttributeExactMatch"
				attributeName="http://macedir.org/entity-category"
				attributeValue="http://www.swamid.se/category/nren-service"/>
			<Rule xsi:type="saml:EntityAttributeExactMatch"
				attributeName="http://macedir.org/entity-category"
				attributeValue="http://www.swamid.se/category/hei-service"/>
		</Rule>

		<Rule xsi:type="saml:EntityAttributeExactMatch"
			attributeName="http://macedir.org/entity-category"
			attributeValue="http://www.swamid.se/category/research-and-education"/>
	</PolicyRequirementRule>

	<AttributeRule attributeID="givenName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="surname">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="displayName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="commonName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="eduPersonPrincipalName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="eduPersonEntitlement">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="eduPersonScopedAffiliation">
		<PermitValueRule xsi:type="OR">
			<Rule xsi:type="AttributeValueString" value="faculty" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="student" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="staff" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="alum" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="member" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="affiliate" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="employee" ignoreCase="true" />
			<Rule xsi:type="AttributeValueString" value="library-walk-in" ignoreCase="true" />
		</PermitValueRule>
	</AttributeRule>

	<AttributeRule attributeID="organizationName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="norEduOrgAcronym">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="countryName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="friendlyCountryName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="schacHomeOrganization">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>


<!-- release norEduPersonNIN to antagning.se -->
<AttributeFilterPolicy id="studeraNU">
	<PolicyRequirementRule xsi:type="OR">
		<Rule xsi:type="Requester" value="https://www.antagning.se/aws-sp" />
		<Rule xsi:type="Requester" value="https://www.antagning.se/ecs-sp" />
		<Rule xsi:type="Requester" value="https://www.universityadmissions.se/aws-sp-en" />
	</PolicyRequirementRule>

	<AttributeRule attributeID="norEduPersonNIN">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>


<!-- Release to testshib.org -->
<!--
<AttributeFilterPolicy id="testShib">
	<PolicyRequirementRule xsi:type="Requester" value="https://sp.testshib.org/shibboleth-sp" />

	<AttributeRule attributeID="givenName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="commonName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="surname">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="principal">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- NyA-webben UHR -->
<!--
Attribute "NyAwebbenEntitlement" must be defined in attribute-resolver.xml
See: http://wiki.swamid.se/display/SWAMID/UHR+NyA-webben
-->
<!--
<AttributeFilterPolicy id="NyAexpert">
	<PolicyRequirementRule xsi:type="OR">
		<Rule xsi:type="Requester" value="https://expert.antagning.se/ecs-sp" />
		<Rule xsi:type="Requester" value="https://expert.testa.antagning.se/ecs-sp" />
		<Rule xsi:type="Requester" value="https://expert.testb.antagning.se/ecs-sp" />
	</PolicyRequirementRule>

	<AttributeRule attributeID="NyAwebbenEntitlement">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- Digicert -->
<!--
See: https://portal.nordu.net/display/Inkubator/TCS+Personal+(eScience)
-->
<!--
<AttributeFilterPolicy id="releaseDigicertEntitlement">
	<PolicyRequirementRule xsi:type="Requester" value="https://www.digicert.com/sso" />

	<AttributeRule attributeID="eduPersonPrincipalName">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>

	<AttributeRule attributeID="displayName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="digicertEntitlement">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="schacHomeOrganization">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- Release special attribute to wisum -->
<!--
Attribute "WisumEntitlement" must be defined in attribute-resolver.xml
See: http://wiki.swamid.se/display/SWAMID/UHR+NyA-webben as a reference
-->
<!--
<AttributeFilterPolicy id="Wisum">
	<PolicyRequirementRule xsi:type="OR">
		<Rule xsi:type="Requester" value="https://www.wisum.its.umu.se/shibboleth" />
		<Rule xsi:type="Requester" value="wisumstage.its.umu.se" />
		<Rule xsi:type="Requester" value="its-utv03.ad.umu.se" />
		<Rule xsi:type="Requester" value="its-pd0328.ad.umu.se" />
	</PolicyRequirementRule>

	<AttributeRule attributeID="WisumEntitlement">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- IOPscience -->
<!--
<AttributeFilterPolicy id="releaseeduPersonScopedAffiliationToIOP">
	<PolicyRequirementRule xsi:type="Requester" value="https://ticket.iop.org/shibboleth" />

	<AttributeRule attributeID="eduPersonScopedAffiliation">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- Research Professional -->
<!--
<AttributeFilterPolicy id="researchProfessional">
	<PolicyRequirementRule xsi:type="Requester" value="https://www.researchprofessional.com/shibboleth" />

	<AttributeRule attributeID="eduPersonPrincipalName">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>

	<AttributeRule attributeID="givenName">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="surname">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>

	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="ANY"/>
	</AttributeRule>
</AttributeFilterPolicy>
-->


<!-- PLACEHOLDER DO NOT REMOVE -->
</AttributeFilterPolicyGroup>
