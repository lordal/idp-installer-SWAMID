<?xml version="1.0" encoding="UTF-8"?>

<!-- 
    
    Deployers should refer to the Shibboleth 2 documentation for a complete list of components 
    and their options.
-->

<AttributeFilterPolicyGroup id="ShibbolethFilterPolicy"
        xmlns="urn:mace:shibboleth:2.0:afp"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="urn:mace:shibboleth:2.0:afp http://shibboleth.net/schema/idp/shibboleth-afp.xsd">
        

    <!--  Release the transient ID to anyone -->
    <AttributeFilterPolicy id="releaseTransientIdToAnyone">
        <PolicyRequirementRule xsi:type="ANY" />
        <AttributeRule attributeID="transientId">
            <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
    </AttributeFilterPolicy>


    <!-- 
        Release eduPersonEntitlement and the permissible values of eduPersonAffiliation
        to any SP that is a member of InCommon, UK federation, or SWITCHaai
    -->

<AttributeFilterPolicy id="releaseToAnyone">
 
    <!-- Policy requirement rule indicates this policy is active for any request -->
    <PolicyRequirementRule xsi:type="ANY"/>
 
    <!-- Attribute rule for the eduPersonAfffiliation attribute -->
    <AttributeRule attributeID="eduPersonAffiliation">
        <!-- Permit value rule that only releases the standard-specififed values for eduPersonAffiliation -->
        <PermitValueRule xsi:type="OR">
            <Rule xsi:type="AttributeValueString" value="faculty" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="student" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="staff" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="alum" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="member" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="affiliate" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="employee" ignoreCase="true"/>
            <Rule xsi:type="AttributeValueString" value="library-walk-in" ignoreCase="true"/>
        </PermitValueRule>

    </AttributeRule>
    <AttributeRule attributeID="eduPersonTargetedID">
               <PermitValueRule xsi:type="ANY" />
    </AttributeRule>
    <AttributeRule attributeID="eduPersonPrincipalName">
                <PermitValueRule xsi:type="ANY" />
    </AttributeRule>
    <AttributeRule attributeID="mail">
                <PermitValueRule xsi:type="ANY" />
    </AttributeRule>

</AttributeFilterPolicy>

<!-- ##########################################
#
#	Release the given name of the user to our portal service provider
#
-->

<AttributeFilterPolicy>
	<PolicyRequirementRule xsi:type="Requester" value="https://sp.testshib.org/shibboleth-sp" />
        
	<AttributeRule attributeID="eduPersonAffiliation">
        	<PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="eduPersonEntitlement">
        	<PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="eduPersonTargetedID">
    		<PermitValueRule xsi:type="ANY" />
    	</AttributeRule>

</AttributeFilterPolicy>

<!-- ##########################################
#
#	DokuWiki Attribute Filter Policy
#
-->

<AttributeFilterPolicy>
	<PolicyRequirementRule xsi:type="Requester" value="https://dokuwiki.cybera.ca/shibboleth" />

	<AttributeRule attributeID="eduPersonTargetedID">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="eduPersonPrincipalName">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="mail">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>	

</AttributeFilterPolicy>

<!-- ##########################################
#
#       TTS.Canarie Attribute Filter Policy
#
-->
<AttributeFilterPolicy>
<PolicyRequirementRule xsi:type="Requester" value="https://tts.canarie.ca/shibboleth" />

	<AttributeRule attributeID="eduPersonPrincipalName">
    		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="cn">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="eduPersonTargetedID">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="email">
		<PermitValueRule xsi:type="ANY" />
	</AttributeRule>
	<AttributeRule attributeID="eduPersonAffiliation">
	                <PermitValueRule xsi:type="ANY" />
	                        </AttributeRule>

</AttributeFilterPolicy>

<!-- ##########################################
#
#       Foodl Attribute Filter Policy
#
-->

<AttributeFilterPolicy>
        <PolicyRequirementRule xsi:type="Requester" value="https://foodl.org/simplesaml" />

        <AttributeRule attributeID="eduPersonTargetedID">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="eduPersonPrincipalName">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="mail">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>

</AttributeFilterPolicy>

<!-- ##########################################
#
#	CANARIE Attribute Filter Ploicy
#
-->  

<AttributeFilterPolicy>
        <PolicyRequirementRule xsi:type="OR">
                <Rule xsi:type="Requester" value="https://collaboration.canarie.ca/shibboleth"/>
                <Rule xsi:type="Requester" value="https://science.canarie.ca/shibboleth"/>
		<Rule xsi:type="Requester" value="http://adfsgw.canarie.ca/adfs/services/trust"/>
	</PolicyRequirementRule>
	
	<AttributeRule attributeID="eduPersonTargetedID">
        	<PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="eduPersonPrincipalName">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="mail">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule> 
	<AttributeRule attributeID="email">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule> 
	<AttributeRule attributeID="cn">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="surname">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="mail">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="givenName">
                <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="eduPersonScopedAffiliation">
                 <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
        <AttributeRule attributeID="eduPersonAffiliation">
                 <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="displayName">
                 <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="eduPersonEntitlement">
                 <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
	<AttributeRule attributeID="preferredLanguage">
                 <PermitValueRule xsi:type="ANY" />
        </AttributeRule>
</AttributeFilterPolicy>


<AttributeFilterPolicy>
    <PolicyRequirementRule xsi:type="Requester" value="https://monitor.eduroam.org/sp/module.php/saml/sp/metadata.php/default-sp" />
    <AttributeRule attributeID="eduPersonPrincipalName">
    <PermitValueRule xsi:type="ANY" />
    </AttributeRule>
    <AttributeRule attributeID="eduPersonTargetedID">
    <PermitValueRule xsi:type="ANY" />
    </AttributeRule>
</AttributeFilterPolicy>


</AttributeFilterPolicyGroup>
